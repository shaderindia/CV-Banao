<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elite Resume Builder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
        }
        
        /* A4 dimensions: 210mm x 297mm = 8.27" x 11.69" at 96 DPI = 794px x 1123px */
        .a4-container {
            width: 210mm;
            min-height: 297mm;
            max-height: 297mm;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .a4-content {
            width: 100%;
            height: 100%;
            padding: 15mm;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
        }
        
        /* Print styles */
        @media print {
            body {
                margin: 0;
                padding: 0;
                background: white;
            }
            
            .a4-container {
                width: 210mm;
                height: 297mm;
                margin: 0;
                box-shadow: none;
                page-break-after: avoid;
            }
            
            .a4-content {
                padding: 15mm;
            }
            
            .no-print {
                display: none !important;
            }
        }
        
        /* Responsive text sizing for A4 */
        .resume-title {
            font-size: 24px;
            line-height: 1.2;
        }
        
        .resume-subtitle {
            font-size: 14px;
            line-height: 1.3;
        }
        
        .resume-section-title {
            font-size: 16px;
            line-height: 1.3;
            margin-bottom: 8px;
        }
        
        .resume-text {
            font-size: 11px;
            line-height: 1.4;
        }
        
        .resume-small-text {
            font-size: 10px;
            line-height: 1.3;
        }
        
        /* Compact spacing for A4 */
        .resume-section {
            margin-bottom: 12px;
        }
        
        .resume-item {
            margin-bottom: 8px;
        }
        
        /* Profile photo sizing */
        .profile-photo {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
        }
        
        /* Skills grid optimization */
        .skills-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 6px;
        }
        
        /* Language items */
        .language-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 2px 0;
        }
        
        /* Cropper modal styles */
        .cropper-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .cropper-container-wrapper {
            background: white;
            padding: 20px;
            border-radius: 8px;
            max-width: 90vw;
            max-height: 90vh;
        }
        
        .cropper-container {
            max-width: 500px;
            max-height: 400px;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">Elite Resume Builder</h1>
            <p class="text-gray-600">For Mechanical Engineers Only</p>
        </div>

        <!-- Main Content -->
        <div class="grid lg:grid-cols-2 gap-8">
            <!-- Form Section -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-semibold mb-6 text-gray-800">Build Your Resume</h2>
                
                <!-- Profile Photo Upload -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Profile Photo</label>
                    <div class="flex items-center space-x-4">
                        <input type="file" id="photoUpload" accept="image/*" class="hidden">
                        <button onclick="document.getElementById('photoUpload').click()" 
                                class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors">
                            <i class="fas fa-camera mr-2"></i>Upload Photo
                        </button>
                        <div id="photoPreview" class="w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center">
                            <i class="fas fa-user text-gray-400"></i>
                        </div>
                    </div>
                </div>

                <!-- Personal Details -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-3 text-gray-700">Personal Details</h3>
                    <div class="grid md:grid-cols-2 gap-4">
                        <input type="text" id="fullName" placeholder="Full Name" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <input type="email" id="email" placeholder="Email" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <input type="tel" id="phone" placeholder="Phone Number" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <input type="text" id="location" placeholder="Location" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <input type="url" id="linkedin" placeholder="LinkedIn Profile" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <input type="url" id="github" placeholder="GitHub Profile" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                </div>

                <!-- Objective/Summary -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-3 text-gray-700">Objective/Summary</h3>
                    <textarea id="objective" placeholder="Write your career objective or professional summary..." 
                              class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent h-24 resize-none"></textarea>
                </div>

                <!-- Education -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-3 text-gray-700">Education</h3>
                    <div id="educationContainer">
                        <div class="education-item border border-gray-200 rounded-lg p-4 mb-3">
                            <div class="grid md:grid-cols-2 gap-3">
                                <input type="text" placeholder="Degree" class="education-degree w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <input type="text" placeholder="Institution" class="education-institution w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <input type="text" placeholder="Year" class="education-year w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <input type="text" placeholder="Grade/CGPA" class="education-grade w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                            <button onclick="removeEducation(this)" class="mt-2 text-red-500 hover:text-red-700 text-sm">
                                <i class="fas fa-trash mr-1"></i>Remove
                            </button>
                        </div>
                    </div>
                    <button onclick="addEducation()" class="text-blue-500 hover:text-blue-700 text-sm">
                        <i class="fas fa-plus mr-1"></i>Add Education
                    </button>
                </div>

                <!-- Skills -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-3 text-gray-700">Technical Skills</h3>
                    <textarea id="skills" placeholder="Enter your technical skills (e.g., AutoCAD, SolidWorks, MATLAB, Python, etc.)" 
                              class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent h-20 resize-none"></textarea>
                </div>

                <!-- Experience -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-3 text-gray-700">Work Experience</h3>
                    <div id="experienceContainer">
                        <div class="experience-item border border-gray-200 rounded-lg p-4 mb-3">
                            <div class="grid md:grid-cols-2 gap-3 mb-3">
                                <input type="text" placeholder="Job Title" class="experience-title w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <input type="text" placeholder="Company" class="experience-company w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <input type="text" placeholder="Duration" class="experience-duration w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <input type="text" placeholder="Location" class="experience-location w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                            <textarea placeholder="Job description and achievements..." class="experience-description w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent h-20 resize-none"></textarea>
                            <button onclick="removeExperience(this)" class="mt-2 text-red-500 hover:text-red-700 text-sm">
                                <i class="fas fa-trash mr-1"></i>Remove
                            </button>
                        </div>
                    </div>
                    <button onclick="addExperience()" class="text-blue-500 hover:text-blue-700 text-sm">
                        <i class="fas fa-plus mr-1"></i>Add Experience
                    </button>
                </div>

                <!-- CAD/CAM Software -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-3 text-gray-700">CAD/CAM Software</h3>
                    <textarea id="cadSoftware" placeholder="List CAD/CAM software you're proficient in (e.g., AutoCAD, SolidWorks, CATIA, Fusion 360, etc.)" 
                              class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent h-20 resize-none"></textarea>
                </div>

                <!-- Languages -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-3 text-gray-700">Languages</h3>
                    <div id="languagesContainer">
                        <div class="language-item flex gap-3 mb-2">
                            <input type="text" placeholder="Language" class="language-name flex-1 p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <select class="language-proficiency p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="Native">Native</option>
                                <option value="Fluent">Fluent</option>
                                <option value="Intermediate">Intermediate</option>
                                <option value="Basic">Basic</option>
                            </select>
                            <button onclick="removeLanguage(this)" class="text-red-500 hover:text-red-700 px-2">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <button onclick="addLanguage()" class="text-blue-500 hover:text-blue-700 text-sm">
                        <i class="fas fa-plus mr-1"></i>Add Language
                    </button>
                </div>

                <!-- Declaration -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-3 text-gray-700">Declaration</h3>
                    <textarea id="declaration" placeholder="I hereby declare that all the information provided above is true to the best of my knowledge..." 
                              class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent h-20 resize-none"></textarea>
                </div>

                <!-- Action Buttons -->
                <div class="flex flex-wrap gap-3">
                    <button onclick="generateResume()" class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg transition-colors">
                        <i class="fas fa-eye mr-2"></i>Preview Resume
                    </button>
                    <button onclick="downloadPDF()" class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-lg transition-colors">
                        <i class="fas fa-download mr-2"></i>Download PDF
                    </button>
                    <button onclick="saveResume()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg transition-colors">
                        <i class="fas fa-save mr-2"></i>Save Resume
                    </button>
                    <button onclick="loadResume()" class="bg-yellow-500 hover:bg-yellow-600 text-white px-6 py-3 rounded-lg transition-colors">
                        <i class="fas fa-upload mr-2"></i>Load Resume
                    </button>
                    <button onclick="resetForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg transition-colors">
                        <i class="fas fa-refresh mr-2"></i>Reset Form
                    </button>
                    <button onclick="shareApp()" class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-lg transition-colors">
                        <i class="fas fa-share mr-2"></i>Share App
                    </button>
                </div>
            </div>

            <!-- Preview Section -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-semibold mb-6 text-gray-800 no-print">Resume Preview</h2>
                
                <!-- A4 Container -->
                <div class="a4-container" id="resumePreview">
                    <div class="a4-content">
                        <div class="text-center text-gray-500 resume-text">
                            Click "Preview Resume" to see your resume here
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Photo Cropper Modal -->
    <div id="cropperModal" class="cropper-modal hidden">
        <div class="cropper-container-wrapper">
            <div class="mb-4">
                <h3 class="text-lg font-semibold">Crop Your Photo</h3>
            </div>
            <div class="cropper-container">
                <img id="cropperImage" style="max-width: 100%;">
            </div>
            <div class="flex justify-end space-x-3 mt-4">
                <button onclick="cancelCrop()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded">
                    Cancel
                </button>
                <button onclick="applyCrop()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">
                    Apply
                </button>
            </div>
        </div>
    </div>

    <script>
        let cropper;
        let croppedImageData = null;

        // Photo upload and cropping
        document.getElementById('photoUpload').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.getElementById('cropperImage');
                    img.src = e.target.result;
                    document.getElementById('cropperModal').classList.remove('hidden');
                    
                    if (cropper) {
                        cropper.destroy();
                    }
                    
                    cropper = new Cropper(img, {
                        aspectRatio: 1,
                        viewMode: 1,
                        minCropBoxWidth: 100,
                        minCropBoxHeight: 100,
                    });
                };
                reader.readAsDataURL(file);
            }
        });

        function cancelCrop() {
            document.getElementById('cropperModal').classList.add('hidden');
            if (cropper) {
                cropper.destroy();
            }
        }

        function applyCrop() {
            if (cropper) {
                const canvas = cropper.getCroppedCanvas({
                    width: 200,
                    height: 200,
                });
                
                croppedImageData = canvas.toDataURL();
                
                const preview = document.getElementById('photoPreview');
                preview.innerHTML = `<img src="${croppedImageData}" class="w-full h-full object-cover rounded-lg">`;
                
                document.getElementById('cropperModal').classList.add('hidden');
                cropper.destroy();
                
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
            }
        }

        // Dynamic form functions
        function addEducation() {
            const container = document.getElementById('educationContainer');
            const div = document.createElement('div');
            div.className = 'education-item border border-gray-200 rounded-lg p-4 mb-3';
            div.innerHTML = `
                <div class="grid md:grid-cols-2 gap-3">
                    <input type="text" placeholder="Degree" class="education-degree w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <input type="text" placeholder="Institution" class="education-institution w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <input type="text" placeholder="Year" class="education-year w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <input type="text" placeholder="Grade/CGPA" class="education-grade w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <button onclick="removeEducation(this)" class="mt-2 text-red-500 hover:text-red-700 text-sm">
                    <i class="fas fa-trash mr-1"></i>Remove
                </button>
            `;
            container.appendChild(div);
        }

        function removeEducation(button) {
            button.closest('.education-item').remove();
        }

        function addExperience() {
            const container = document.getElementById('experienceContainer');
            const div = document.createElement('div');
            div.className = 'experience-item border border-gray-200 rounded-lg p-4 mb-3';
            div.innerHTML = `
                <div class="grid md:grid-cols-2 gap-3 mb-3">
                    <input type="text" placeholder="Job Title" class="experience-title w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <input type="text" placeholder="Company" class="experience-company w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <input type="text" placeholder="Duration" class="experience-duration w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <input type="text" placeholder="Location" class="experience-location w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <textarea placeholder="Job description and achievements..." class="experience-description w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent h-20 resize-none"></textarea>
                <button onclick="removeExperience(this)" class="mt-2 text-red-500 hover:text-red-700 text-sm">
                    <i class="fas fa-trash mr-1"></i>Remove
                </button>
            `;
            container.appendChild(div);
        }

        function removeExperience(button) {
            button.closest('.experience-item').remove();
        }

        function addLanguage() {
            const container = document.getElementById('languagesContainer');
            const div = document.createElement('div');
            div.className = 'language-item flex gap-3 mb-2';
            div.innerHTML = `
                <input type="text" placeholder="Language" class="language-name flex-1 p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <select class="language-proficiency p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="Native">Native</option>
                    <option value="Fluent">Fluent</option>
                    <option value="Intermediate">Intermediate</option>
                    <option value="Basic">Basic</option>
                </select>
                <button onclick="removeLanguage(this)" class="text-red-500 hover:text-red-700 px-2">
                    <i class="fas fa-trash"></i>
                </button>
            `;
            container.appendChild(div);
        }

        function removeLanguage(button) {
            button.closest('.language-item').remove();
        }

        // Generate resume preview
        function generateResume() {
            const resumePreview = document.getElementById('resumePreview');
            
            // Collect form data
            const data = {
                fullName: document.getElementById('fullName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                location: document.getElementById('location').value,
                linkedin: document.getElementById('linkedin').value,
                github: document.getElementById('github').value,
                objective: document.getElementById('objective').value,
                skills: document.getElementById('skills').value,
                cadSoftware: document.getElementById('cadSoftware').value,
                declaration: document.getElementById('declaration').value,
                photo: croppedImageData
            };

            // Collect education data
            const educationItems = document.querySelectorAll('.education-item');
            data.education = Array.from(educationItems).map(item => ({
                degree: item.querySelector('.education-degree').value,
                institution: item.querySelector('.education-institution').value,
                year: item.querySelector('.education-year').value,
                grade: item.querySelector('.education-grade').value
            })).filter(edu => edu.degree || edu.institution);

            // Collect experience data
            const experienceItems = document.querySelectorAll('.experience-item');
            data.experience = Array.from(experienceItems).map(item => ({
                title: item.querySelector('.experience-title').value,
                company: item.querySelector('.experience-company').value,
                duration: item.querySelector('.experience-duration').value,
                location: item.querySelector('.experience-location').value,
                description: item.querySelector('.experience-description').value
            })).filter(exp => exp.title || exp.company);

            // Collect languages data
            const languageItems = document.querySelectorAll('.language-item');
            data.languages = Array.from(languageItems).map(item => ({
                name: item.querySelector('.language-name').value,
                proficiency: item.querySelector('.language-proficiency').value
            })).filter(lang => lang.name);

            // Generate HTML
            resumePreview.innerHTML = `
                <div class="a4-content">
                    <!-- Header Section -->
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex-1">
                            <h1 class="resume-title font-bold text-gray-800 mb-1">${data.fullName || 'Your Name'}</h1>
                            <p class="resume-subtitle text-gray-600 mb-2">Mechanical Engineer</p>
                            <div class="resume-small-text text-gray-600 space-y-1">
                                ${data.email ? `<div><i class="fas fa-envelope w-4"></i> ${data.email}</div>` : ''}
                                ${data.phone ? `<div><i class="fas fa-phone w-4"></i> ${data.phone}</div>` : ''}
                                ${data.location ? `<div><i class="fas fa-map-marker-alt w-4"></i> ${data.location}</div>` : ''}
                                ${data.linkedin ? `<div><i class="fab fa-linkedin w-4"></i> ${data.linkedin}</div>` : ''}
                                ${data.github ? `<div><i class="fab fa-github w-4"></i> ${data.github}</div>` : ''}
                            </div>
                        </div>
                        ${data.photo ? `<div class="ml-4"><img src="${data.photo}" class="profile-photo"></div>` : ''}
                    </div>

                    <!-- Objective Section -->
                    ${data.objective ? `
                        <div class="resume-section">
                            <h2 class="resume-section-title font-semibold text-gray-800 border-b border-gray-300 pb-1">OBJECTIVE</h2>
                            <p class="resume-text text-gray-700">${data.objective}</p>
                        </div>
                    ` : ''}

                    <!-- Education Section -->
                    ${data.education.length > 0 ? `
                        <div class="resume-section">
                            <h2 class="resume-section-title font-semibold text-gray-800 border-b border-gray-300 pb-1">EDUCATION</h2>
                            ${data.education.map(edu => `
                                <div class="resume-item">
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <h3 class="resume-text font-semibold text-gray-800">${edu.degree}</h3>
                                            <p class="resume-small-text text-gray-600">${edu.institution}</p>
                                        </div>
                                        <div class="text-right">
                                            <p class="resume-small-text text-gray-600">${edu.year}</p>
                                            ${edu.grade ? `<p class="resume-small-text text-gray-600">${edu.grade}</p>` : ''}
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    ` : ''}

                    <!-- Technical Skills Section -->
                    ${data.skills ? `
                        <div class="resume-section">
                            <h2 class="resume-section-title font-semibold text-gray-800 border-b border-gray-300 pb-1">TECHNICAL SKILLS</h2>
                            <div class="skills-grid">
                                ${data.skills.split(',').map(skill => `
                                    <span class="resume-small-text bg-gray-100 px-2 py-1 rounded text-gray-700">${skill.trim()}</span>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}

                    <!-- CAD/CAM Software Section -->
                    ${data.cadSoftware ? `
                        <div class="resume-section">
                            <h2 class="resume-section-title font-semibold text-gray-800 border-b border-gray-300 pb-1">CAD/CAM SOFTWARE</h2>
                            <div class="skills-grid">
                                ${data.cadSoftware.split(',').map(software => `
                                    <span class="resume-small-text bg-blue-100 px-2 py-1 rounded text-blue-700">${software.trim()}</span>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}

                    <!-- Work Experience Section -->
                    ${data.experience.length > 0 ? `
                        <div class="resume-section">
                            <h2 class="resume-section-title font-semibold text-gray-800 border-b border-gray-300 pb-1">WORK EXPERIENCE</h2>
                            ${data.experience.map(exp => `
                                <div class="resume-item">
                                    <div class="flex justify-between items-start mb-1">
                                        <div>
                                            <h3 class="resume-text font-semibold text-gray-800">${exp.title}</h3>
                                            <p class="resume-small-text text-gray-600">${exp.company}${exp.location ? `, ${exp.location}` : ''}</p>
                                        </div>
                                        <p class="resume-small-text text-gray-600">${exp.duration}</p>
                                    </div>
                                    ${exp.description ? `<p class="resume-small-text text-gray-700">${exp.description}</p>` : ''}
                                </div>
                            `).join('')}
                        </div>
                    ` : ''}

                    <!-- Languages Section -->
                    ${data.languages.length > 0 ? `
                        <div class="resume-section">
                            <h2 class="resume-section-title font-semibold text-gray-800 border-b border-gray-300 pb-1">LANGUAGES</h2>
                            <div class="grid grid-cols-2 gap-2">
                                ${data.languages.map(lang => `
                                    <div class="language-item">
                                        <span class="resume-small-text text-gray-700">${lang.name}</span>
                                        <span class="resume-small-text text-gray-500">${lang.proficiency}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}

                    <!-- Declaration Section -->
                    ${data.declaration ? `
                        <div class="resume-section mt-auto">
                            <h2 class="resume-section-title font-semibold text-gray-800 border-b border-gray-300 pb-1">DECLARATION</h2>
                            <p class="resume-small-text text-gray-700">${data.declaration}</p>
                        </div>
                    ` : ''}
                </div>
            `;

            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 }
            });
        }

        // Download PDF function
        async function downloadPDF() {
            const { jsPDF } = window.jspdf;
            const element = document.getElementById('resumePreview');
            
            if (!element.innerHTML.includes('a4-content') || element.innerHTML.includes('Click "Preview Resume"')) {
                alert('Please generate the resume preview first!');
                return;
            }

            try {
                // Create canvas from the resume element
                const canvas = await html2canvas(element, {
                    scale: 2,
                    useCORS: true,
                    allowTaint: true,
                    backgroundColor: '#ffffff',
                    width: 794, // A4 width in pixels at 96 DPI
                    height: 1123 // A4 height in pixels at 96 DPI
                });

                // Create PDF with A4 dimensions
                const pdf = new jsPDF('p', 'mm', 'a4');
                const imgData = canvas.toDataURL('image/png');
                
                // Add image to PDF (A4 size: 210mm x 297mm)
                pdf.addImage(imgData, 'PNG', 0, 0, 210, 297);
                
                // Download the PDF
                const fileName = document.getElementById('fullName').value || 'Resume';
                pdf.save(`${fileName}_Resume.pdf`);

                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
            } catch (error) {
                console.error('Error generating PDF:', error);
                alert('Error generating PDF. Please try again.');
            }
        }

        // Save resume data
        function saveResume() {
            const data = {
                fullName: document.getElementById('fullName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                location: document.getElementById('location').value,
                linkedin: document.getElementById('linkedin').value,
                github: document.getElementById('github').value,
                objective: document.getElementById('objective').value,
                skills: document.getElementById('skills').value,
                cadSoftware: document.getElementById('cadSoftware').value,
                declaration: document.getElementById('declaration').value,
                photo: croppedImageData
            };

            // Save education data
            const educationItems = document.querySelectorAll('.education-item');
            data.education = Array.from(educationItems).map(item => ({
                degree: item.querySelector('.education-degree').value,
                institution: item.querySelector('.education-institution').value,
                year: item.querySelector('.education-year').value,
                grade: item.querySelector('.education-grade').value
            }));

            // Save experience data
            const experienceItems = document.querySelectorAll('.experience-item');
            data.experience = Array.from(experienceItems).map(item => ({
                title: item.querySelector('.experience-title').value,
                company: item.querySelector('.experience-company').value,
                duration: item.querySelector('.experience-duration').value,
                location: item.querySelector('.experience-location').value,
                description: item.querySelector('.experience-description').value
            }));

            // Save languages data
            const languageItems = document.querySelectorAll('.language-item');
            data.languages = Array.from(languageItems).map(item => ({
                name: item.querySelector('.language-name').value,
                proficiency: item.querySelector('.language-proficiency').value
            }));

            localStorage.setItem('resumeData', JSON.stringify(data));
            alert('Resume saved successfully!');
            
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 }
            });
        }

        // Load resume data
        function loadResume() {
            const savedData = localStorage.getItem('resumeData');
            if (!savedData) {
                alert('No saved resume found!');
                return;
            }

            const data = JSON.parse(savedData);

            // Load basic fields
            document.getElementById('fullName').value = data.fullName || '';
            document.getElementById('email').value = data.email || '';
            document.getElementById('phone').value = data.phone || '';
            document.getElementById('location').value = data.location || '';
            document.getElementById('linkedin').value = data.linkedin || '';
            document.getElementById('github').value = data.github || '';
            document.getElementById('objective').value = data.objective || '';
            document.getElementById('skills').value = data.skills || '';
            document.getElementById('cadSoftware').value = data.cadSoftware || '';
            document.getElementById('declaration').value = data.declaration || '';

            // Load photo
            if (data.photo) {
                croppedImageData = data.photo;
                const preview = document.getElementById('photoPreview');
                preview.innerHTML = `<img src="${data.photo}" class="w-full h-full object-cover rounded-lg">`;
            }

            // Load education data
            if (data.education) {
                const container = document.getElementById('educationContainer');
                container.innerHTML = '';
                data.education.forEach(edu => {
                    addEducation();
                    const items = container.querySelectorAll('.education-item');
                    const lastItem = items[items.length - 1];
                    lastItem.querySelector('.education-degree').value = edu.degree || '';
                    lastItem.querySelector('.education-institution').value = edu.institution || '';
                    lastItem.querySelector('.education-year').value = edu.year || '';
                    lastItem.querySelector('.education-grade').value = edu.grade || '';
                });
            }

            // Load experience data
            if (data.experience) {
                const container = document.getElementById('experienceContainer');
                container.innerHTML = '';
                data.experience.forEach(exp => {
                    addExperience();
                    const items = container.querySelectorAll('.experience-item');
                    const lastItem = items[items.length - 1];
                    lastItem.querySelector('.experience-title').value = exp.title || '';
                    lastItem.querySelector('.experience-company').value = exp.company || '';
                    lastItem.querySelector('.experience-duration').value = exp.duration || '';
                    lastItem.querySelector('.experience-location').value = exp.location || '';
                    lastItem.querySelector('.experience-description').value = exp.description || '';
                });
            }

            // Load languages data
            if (data.languages) {
                const container = document.getElementById('languagesContainer');
                container.innerHTML = '';
                data.languages.forEach(lang => {
                    addLanguage();
                    const items = container.querySelectorAll('.language-item');
                    const lastItem = items[items.length - 1];
                    lastItem.querySelector('.language-name').value = lang.name || '';
                    lastItem.querySelector('.language-proficiency').value = lang.proficiency || 'Intermediate';
                });
            }

            alert('Resume loaded successfully!');
            
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 }
            });
        }

        // Reset form
        function resetForm() {
            if (confirm('Are you sure you want to reset the form? All data will be lost.')) {
                document.querySelectorAll('input, textarea, select').forEach(element => {
                    element.value = '';
                });
                
                document.getElementById('photoPreview').innerHTML = '<i class="fas fa-user text-gray-400"></i>';
                croppedImageData = null;
                
                // Reset dynamic sections
                document.getElementById('educationContainer').innerHTML = `
                    <div class="education-item border border-gray-200 rounded-lg p-4 mb-3">
                        <div class="grid md:grid-cols-2 gap-3">
                            <input type="text" placeholder="Degree" class="education-degree w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <input type="text" placeholder="Institution" class="education-institution w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <input type="text" placeholder="Year" class="education-year w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <input type="text" placeholder="Grade/CGPA" class="education-grade w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <button onclick="removeEducation(this)" class="mt-2 text-red-500 hover:text-red-700 text-sm">
                            <i class="fas fa-trash mr-1"></i>Remove
                        </button>
                    </div>
                `;
                
                document.getElementById('experienceContainer').innerHTML = `
                    <div class="experience-item border border-gray-200 rounded-lg p-4 mb-3">
                        <div class="grid md:grid-cols-2 gap-3 mb-3">
                            <input type="text" placeholder="Job Title" class="experience-title w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <input type="text" placeholder="Company" class="experience-company w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <input type="text" placeholder="Duration" class="experience-duration w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <input type="text" placeholder="Location" class="experience-location w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <textarea placeholder="Job description and achievements..." class="experience-description w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent h-20 resize-none"></textarea>
                        <button onclick="removeExperience(this)" class="mt-2 text-red-500 hover:text-red-700 text-sm">
                            <i class="fas fa-trash mr-1"></i>Remove
                        </button>
                    </div>
                `;
                
                document.getElementById('languagesContainer').innerHTML = `
                    <div class="language-item flex gap-3 mb-2">
                        <input type="text" placeholder="Language" class="language-name flex-1 p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <select class="language-proficiency p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="Native">Native</option>
                            <option value="Fluent">Fluent</option>
                            <option value="Intermediate">Intermediate</option>
                            <option value="Basic">Basic</option>
                        </select>
                        <button onclick="removeLanguage(this)" class="text-red-500 hover:text-red-700 px-2">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                document.getElementById('resumePreview').innerHTML = `
                    <div class="a4-content">
                        <div class="text-center text-gray-500 resume-text">
                            Click "Preview Resume" to see your resume here
                        </div>
                    </div>
                `;
                
                alert('Form reset successfully!');
            }
        }

        // Share app
        function shareApp() {
            if (navigator.share) {
                navigator.share({
                    title: 'Elite Resume Builder',
                    text: 'Check out this amazing resume builder for mechanical engineers!',
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(window.location.href).then(() => {
                    alert('App link copied to clipboard!');
                });
            }
            
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 }
            });
        }

        // Initialize with default values
        document.addEventListener('DOMContentLoaded', function() {
            // Set default declaration text
            document.getElementById('declaration').value = 'I hereby declare that all the information provided above is true to the best of my knowledge and belief.';
        });
    </script>
</body>
</html>